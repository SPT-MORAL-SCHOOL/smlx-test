<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบคณะกรรมการนักเรียนขับเคลื่อนโรงเรียนคุณธรรม สพฐ. โรงเรียนสตรีพัทลุง</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
    <style>
        /* ==========================================================
           1. CSS Reset & Global Styles
           ========================================================== */
        :root {
            --color-primary: #004d99; /* น้ำเงินเข้ม สตรีพัทลุง */
            --color-secondary: #ffffff; /* ขาว */
            --color-shadow: rgba(0, 0, 0, 0.1);
            --color-hover: rgba(0, 77, 153, 0.08); /* น้ำเงินอ่อนโปร่งแสง */
            --color-background: #f4f7f6; /* พื้นหลังอ่อนๆ */
            --border-radius: 12px;
            --transparency-bg: rgba(255, 255, 255, 0.95); /* พื้นหลังโปร่งแสงเล็กน้อย */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Sarabun', sans-serif;
        }

        body {
            background-color: var(--color-background);
            line-height: 1.6;
        }

        /* ==========================================================
           2. Common Styles (โค้งมน, เงา, โปร่งแสง)
           ========================================================== */
        .card {
            background-color: var(--transparency-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 5px 20px var(--color-shadow);
            padding: 30px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .interactive-element {
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 8px;
        }

        .interactive-element:hover {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }
        
        .interactive-element:active {
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transform: translateY(0);
        }

        /* Input & Button Styles */
        input:not([type="checkbox"]), textarea, select {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.9);
            transition: border-color 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 5px rgba(0, 77, 153, 0.3);
        }

        button.btn-primary {
            padding: 12px 20px;
            background-color: var(--color-primary);
            color: white;
            border: none;
            font-weight: 600;
        }

        button.btn-secondary {
            background-color: transparent;
            color: var(--color-primary);
            border: 1px solid var(--color-primary);
            padding: 12px 20px;
            font-weight: 600;
        }

        /* ==========================================================
           3. Authentication View
           ========================================================== */
        #auth-view {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        #auth-view .card {
            width: 90%;
            max-width: 450px;
        }

        .logo-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo-container img {
            width: 100px;
            height: 100px;
            object-fit: contain;
            margin-bottom: 10px;
        }
        
        .logo-container h2 {
            color: var(--color-primary);
            font-weight: 700;
        }

        /* ==========================================================
           4. Main Application View (App-View)
           ========================================================== */
        .main-app-container {
            display: none;
            min-height: 100vh;
            background-color: var(--color-background);
        }

        /* Header & Navigation */
        #app-header {
            background-color: var(--transparency-bg);
            padding: 15px 30px;
            box-shadow: 0 2px 10px var(--color-shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        #app-header nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        #main-menu {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .menu-item {
            padding: 10px 15px;
            text-decoration: none;
            color: #333;
            font-weight: 500;
        }
        
        .menu-item.active {
            background-color: var(--color-primary);
            color: white;
            font-weight: 600;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .menu-item:not(.active):hover {
            background-color: var(--color-hover);
            color: var(--color-primary);
        }

        /* Content Area */
        #app-content {
            padding: 30px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ==========================================================
           5. Footer & Responsive Design
           ========================================================= */
        .footer {
            width: 100%;
            text-align: center;
            padding: 15px 0;
            font-size: 0.8em;
            color: #777;
            background-color: var(--color-background);
        }
        
        /* Mobile Adjustments */
        @media (max-width: 768px) {
            #app-header nav {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            #main-menu {
                justify-content: center;
            }
        }
    </style>
</head>
<body>

    <div id="auth-view">
        <div class="card">
            <div class="logo-container">
                <img src="https://img5.pic.in.th/file/secure-sv1/IMG_25650953161d1c1bbdd8.jpeg" alt="Logo สตรีพัทลุง">
                <h2 id="form-title">เข้าสู่ระบบ</h2>
                <p style="color: #666; font-size: 0.9em;">ระบบคณะกรรมการนักเรียนขับเคลื่อนโรงเรียนคุณธรรม สพฐ.</p>
            </div>

            <form id="login-form">
                <input type="email" id="login-email" placeholder="อีเมล" required>
                <input type="password" id="login-password" placeholder="รหัสผ่าน" required>
                <button type="submit" class="btn-primary interactive-element">เข้าสู่ระบบ</button>
            </form>

            <form id="register-form" style="display: none;">
                <input type="text" id="reg-name" placeholder="ชื่อ-สกุล" required>
                <input type="text" id="reg-student-id" placeholder="รหัสนักเรียน/ตำแหน่ง" required>
                <input type="email" id="reg-email" placeholder="อีเมล" required>
                <input type="password" id="reg-password" placeholder="รหัสผ่าน (6 ตัวขึ้นไป)" required>
                <button type="submit" class="btn-primary interactive-element">สมัครสมาชิก</button>
                <p style="text-align: center; margin-top: 10px; font-size: 0.8em; color: #888;">*ต้องรอการอนุมัติจาก Admin ก่อนเข้าใช้งาน</p>
            </form>
            
            <div class="form-switch" style="text-align: center; margin-top: 20px;">
                <p id="switch-text">ยังไม่มีบัญชี? <a href="#" onclick="switchForm('register')">สมัครสมาชิก</a></p>
            </div>

            <div id="error-message" style="color: red; text-align: center; margin-top: 15px; display: none;"></div>
        </div>
    </div>
    
    <div id="app-view" class="main-app-container">
        <header id="app-header">
            <nav>
                <div style="font-size: 1.2em; font-weight: 700; color: var(--color-primary);">SPT MORAL SYSTEM</div>
                <div id="main-menu">
                    </div>
                <button id="logout-btn" class="btn-secondary interactive-element" style="padding: 8px 15px;">ออกจากระบบ</button>
            </nav>
        </header>

        <main id="app-content">
            </main>

    </div>

    <footer class="footer">
        &copy; 2024 SPT MORAL SCHOOL - โรงเรียนคุณธรรม สพฐ. โรงเรียนสตรีพัทลุง | All Rights Reserved
    </footer>

    <script>
        // 1. Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAOgu5-F-iLrFdPjJ0QW2BxorG-SNtZOKk",
            authDomain: "smlc-30912.firebaseapp.com",
            projectId: "smlc-30912",
            storageBucket: "smlc-30912.firebasestorage.app",
            messagingSenderId: "264699595987",
            appId: "1:264699595987:web:3a0388e5aa87397b5e1826",
            measurementId: "G-35KJ6PSQFW"
        };

        // Initialize Firebase Services
        const app = firebase.initializeApp(firebaseConfig);
        const auth = app.auth();
        const db = app.firestore();
        const storage = app.storage();

        // Global Variables
        const ADMIN_EMAIL = 'sptmorral@spt.ac.th';
        let currentUserData = null; 
        let currentPage = '';

        // ==========================================================
        // UI Utility Functions
        // ==========================================================
        
        /** Switches between Login and Register Forms */
        function switchForm(mode) {
            document.getElementById('login-form').style.display = (mode === 'login') ? 'block' : 'none';
            document.getElementById('register-form').style.display = (mode === 'register') ? 'block' : 'none';
            document.getElementById('form-title').textContent = (mode === 'login') ? 'เข้าสู่ระบบ' : 'สมัครสมาชิก';
            document.getElementById('switch-text').innerHTML = (mode === 'login') 
                ? 'ยังไม่มีบัญชี? <a href="#" onclick="switchForm(\'register\')">สมัครสมาชิก</a>' 
                : 'มีบัญชีอยู่แล้ว? <a href="#" onclick="switchForm(\'login\')">เข้าสู่ระบบ</a>';
            document.getElementById('error-message').style.display = 'none';
        }

        /** Displays an error message on the auth screen */
        function displayError(message) {
            const errorElement = document.getElementById('error-message');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
            setTimeout(() => { errorElement.style.display = 'none'; }, 5000);
        }

        // ==========================================================
        // Authentication Logic
        // ==========================================================
        
        // 1. Handle User Login
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            try {
                // Firebase signs in the user
                await auth.signInWithEmailAndPassword(email, password);
                // onAuthStateChanged will handle the rest
            } catch (error) {
                console.error("Login Error:", error.code);
                let message = "การเข้าสู่ระบบล้มเหลว. โปรดตรวจสอบอีเมลและรหัสผ่าน";
                if (error.code === 'auth/user-not-found') message = "ไม่พบผู้ใช้งานนี้ในระบบ";
                else if (error.code === 'auth/wrong-password') message = "รหัสผ่านไม่ถูกต้อง";
                displayError(message);
            }
        });

        // 2. Handle User Registration
        document.getElementById('register-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            const name = document.getElementById('reg-name').value;
            const studentId = document.getElementById('reg-student-id').value;

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Save user details to Firestore for Admin approval
                await db.collection('users').doc(user.uid).set({
                    email: email,
                    name: name,
                    studentId: studentId,
                    isAdmin: (email === ADMIN_EMAIL),
                    status: 'Pending', // Requires Admin approval
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                alert('สมัครสมาชิกสำเร็จ! บัญชีของคุณอยู่ระหว่างรอการอนุมัติจาก Admin');
                switchForm('login');
            } catch (error) {
                console.error("Register Error:", error.code);
                let message = "การสมัครสมาชิกล้มเหลว. โปรดลองอีกครั้ง";
                if (error.code === 'auth/email-already-in-use') message = "อีเมลนี้ถูกใช้สมัครสมาชิกไปแล้ว";
                else if (error.code === 'auth/weak-password') message = "รหัสผ่านต้องมีความยาวอย่างน้อย 6 ตัวอักษร";
                displayError(message);
            }
        });

        // 3. Handle Logout
        document.getElementById('logout-btn').addEventListener('click', () => {
            auth.signOut();
        });

        // 4. Authentication State Change Listener
        auth.onAuthStateChanged(async (user) => {
            const authView = document.getElementById('auth-view');
            const appView = document.getElementById('app-view');

            if (user) {
                // User signed in, fetch role and status
                const doc = await db.collection('users').doc(user.uid).get();
                
                if (doc.exists) {
                    currentUserData = doc.data();

                    if (currentUserData.status === 'Approved' || currentUserData.isAdmin) {
                        // User is approved or is the Admin
                        authView.style.display = 'none';
                        appView.style.display = 'block';
                        loadAppLayout(currentUserData.isAdmin); 
                        navigateTo('home');

                    } else if (currentUserData.status === 'Pending') {
                        // Pending approval
                        auth.signOut(); 
                        alert('บัญชีของคุณอยู่ระหว่างรอการอนุมัติจาก Admin');
                    }
                } else {
                    // Data inconsistency
                    auth.signOut();
                    displayError('ข้อมูลผู้ใช้งานไม่สมบูรณ์ โปรดติดต่อ Admin');
                }
                
            } else {
                // User signed out, show login view
                authView.style.display = 'flex';
                appView.style.display = 'none';
                currentUserData = null;
                switchForm('login');
            }
        });


        // ==========================================================
        // Application Layout & Navigation Logic (หลัง Login)
        // ==========================================================

        const pages = {
            'home': { title: 'หน้าหลัก', isAdmin: false, content: 'loadHomeContent' },
            'activities': { title: 'หน้ากิจกรรม', isAdmin: false, content: 'loadActivitiesContent' },
            'borrow': { title: 'ระบบยืม-คืนอุปกรณ์', isAdmin: false, content: 'loadBorrowContent' },
            'calendar': { title: 'ระบบปฏิทิน', isAdmin: false, content: 'loadCalendarContent' },
            'links': { title: 'หน้าลิงก์', isAdmin: false, content: 'loadLinksContent' },
            'documents': { title: 'หน้าเอกสาร', isAdmin: false, content: 'loadDocumentsContent' },
            'admin': { title: 'หน้าจัดการระบบ', isAdmin: true, content: 'loadAdminContent' }
        };
        
        /** Builds the main menu based on user role. */
        function loadAppLayout(isAdmin) {
            const menuContainer = document.getElementById('main-menu');
            menuContainer.innerHTML = '';

            for (const key in pages) {
                const page = pages[key];
                if (page.isAdmin && !isAdmin) continue; // Hide Admin page from regular users
                
                const menuItem = document.createElement('a');
                menuItem.href = '#';
                menuItem.textContent = page.title;
                menuItem.id = `menu-${key}`;
                menuItem.className = 'menu-item interactive-element';
                menuItem.onclick = (e) => {
                    e.preventDefault();
                    navigateTo(key);
                };
                menuContainer.appendChild(menuItem);
            }
        }
        
        /** Changes the view and highlights the menu item. */
        function navigateTo(pageKey) {
            if (!pages[pageKey]) return;
            
            // 1. Highlight Menu
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            const currentMenu = document.getElementById(`menu-${pageKey}`);
            if (currentMenu) currentMenu.classList.add('active');
            currentPage = pageKey;

            // 2. Load Content (Call the specific content function)
            const contentLoader = pages[pageKey].content;
            if (typeof window[contentLoader] === 'function') {
                window[contentLoader]();
            } else {
                document.getElementById('app-content').innerHTML = `<div class="card"><h1>${pages[pageKey].title}</h1><p>⚠️ ฟังก์ชัน <code>${contentLoader}</code> ยังไม่ถูกเขียน. โปรดเพิ่ม Logic การแสดงผลและการจัดการข้อมูล Firebase ที่นี่</p></div>`;
            }
        }

        // ==========================================================
        // Page Content Rendering Functions (MOCK UP)
        // NOTE: Functions below are MOCKUPs. You must fill them 
        // with the actual Firebase logic (CRUD operations).
        // ==========================================================

        function loadHomeContent() {
            document.getElementById('app-content').innerHTML = `
                <div class="card">
                    <h1>📊 ${pages.home.title}</h1>
                    <p style="margin-bottom: 20px;">แสดงสรุปภาพรวมปฏิทินกิจกรรม และสถานะการยืม-คืนอุปกรณ์ปัจจุบัน</p>
                </div>
                
                <div class="card">
                    <h2>🗓️ ปฏิทินกิจกรรมโรงเรียน (Full Calendar Display)</h2>
                    <div id="home-calendar-display" style="min-height: 400px; background: #f9f9f9; border-radius: 8px; padding: 20px;">
                        <p>ตารางปฏิทินจริงจะถูกโหลดด้วย FullCalendar JS Library และข้อมูลจาก Firestore <code>calendar</code> collection</p>
                    </div>
                </div>

                <div class="card">
                    <h2>🛠️ รายการอุปกรณ์ที่ถูกยืมอยู่ (ปัจจุบัน)</h2>
                    <div id="home-borrow-display">
                        <p>ข้อมูลการยืมอุปกรณ์ที่ <code>status: 'Borrowing'</code> จะแสดงที่นี่</p>
                        <ul>
                            <li>[Mock] ผู้ใช้ A ยืม Projector (ถึง 25/10/2024)</li>
                            <li>[Mock] ผู้ใช้ B ยืม Megaphone (ถึง 26/10/2024)</li>
                        </ul>
                    </div>
                </div>
            `;
            // *ต้องเพิ่ม Logic ในการดึงข้อมูลและแสดงผลปฏิทินจริง และสรุปการยืม*
        }

        function loadActivitiesContent() {
            const isAdmin = currentUserData.isAdmin;
            const content = `
                <div class="card">
                    <h1>📝 ${pages.activities.title}</h1>
                    <p>ทุกคนสามารถเพิ่มกิจกรรมได้ แต่ต้องรอ Admin อนุมัติ</p>
                    <button class="btn-primary interactive-element" onclick="showActivityForm()">+ เพิ่มกิจกรรมใหม่</button>
                </div>
                
                <div id="activity-list" class="card" style="margin-top: 20px;">
                    <h2>รายการกิจกรรมที่รอ/ได้รับการอนุมัติ</h2>
                    <p>รายการกิจกรรมทั้งหมด (มีการกรองสถานะ: ${isAdmin ? 'ทั้งหมด' : 'อนุมัติแล้ว'}) จะแสดงในรูปแบบ Card สวยงามที่นี่</p>
                    <div class="card interactive-element" style="padding: 15px; margin-top: 10px; border: 1px solid #eee;">
                        <strong>กิจกรรม:</strong> ทำความดีเพื่อโรงเรียน <br>
                        <strong>สถานะ:</strong> รอการอนุมัติ | <strong>วันที่:</strong> 30 ต.ค.
                    </div>
                </div>
            `;
            document.getElementById('app-content').innerHTML = content;
        }

        function loadBorrowContent() {
            const isAdmin = currentUserData.isAdmin;
            document.getElementById('app-content').innerHTML = `
                <div class="card">
                    <h1>🛠️ ${pages.borrow.title}</h1>
                    <h2>1. คำขอยืมอุปกรณ์</h2>
                    <form id="borrow-form">
                        <select id="borrow-item" required><option value="">เลือกอุปกรณ์</option></select>
                        <input type="number" id="borrow-qty" placeholder="จำนวน" required min="1">
                        <label>วันที่ยืม:</label><input type="date" id="borrow-start" required>
                        <label>วันที่คืน:</label><input type="date" id="borrow-end" required>
                        <textarea id="borrow-purpose" placeholder="จุดประสงค์การยืม" required></textarea>
                        <button type="submit" class="btn-primary interactive-element">ส่งคำขอยืม</button>
                    </form>
                </div>

                <div class="card">
                    <h2>2. อุปกรณ์ที่ฉันยืมอยู่ (สำหรับคืน)</h2>
                    <div id="my-borrow-list">
                        <div class="card interactive-element" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; margin-top: 10px;">
                            <span>Projector (ยืมถึง 25/10)</span>
                            <button class="btn-secondary" onclick="confirmReturn('itemId123')">คืนอุปกรณ์</button>
                        </div>
                    </div>
                </div>
                ${isAdmin ? '<div class="card"><h2>3. เพิ่ม/จัดการอุปกรณ์ (Admin)</h2><p>ฟอร์มและรายการสำหรับ Admin ในการเพิ่ม/แก้ไข/ลบอุปกรณ์คงคลัง</p></div>' : ''}
            `;
            // *ต้องเพิ่ม Logic ในการส่งคำขอยืม, แสดงรายการยืมของเรา, และฟังก์ชันยืนยันการคืน*
        }

        function loadCalendarContent() {
            const isAdmin = currentUserData.isAdmin;
            document.getElementById('app-content').innerHTML = `
                <div class="card">
                    <h1>🗓️ ${pages.calendar.title}</h1>
                    <p>ทุกคนสามารถเพิ่มรายการปฏิทินได้ แต่ต้องรอ Admin อนุมัติ</p>
                    <form id="calendar-form">
                        <input type="text" id="cal-detail" placeholder="รายละเอียดกิจกรรม/การประชุม" required>
                        <label>ประเภท:</label>
                        <select id="cal-type" required>
                            <option value="activity">กิจกรรม</option>
                            <option value="meeting">ประชุม</option>
                        </select>
                        <label>วันที่เริ่ม:</label><input type="datetime-local" id="cal-start" required>
                        <label>วันที่สิ้นสุด:</label><input type="datetime-local" id="cal-end" required>
                        <input type="text" id="cal-location" placeholder="สถานที่" required>
                        <button type="submit" class="btn-primary interactive-element">ส่งคำขอเพิ่มปฏิทิน</button>
                    </form>
                </div>
                
                <div class="card">
                    <h2>รายการปฏิทินที่ส่งคำขอ</h2>
                    <p>ตารางรายการปฏิทินที่รอการอนุมัติจะแสดงที่นี่</p>
                </div>
            `;
            // *ต้องเพิ่ม Logic ในการส่งคำขอปฏิทินและการแสดงรายการรออนุมัติ*
        }

        function loadLinksContent() {
            const isAdmin = currentUserData.isAdmin;
            document.getElementById('app-content').innerHTML = `
                <div class="card">
                    <h1>🔗 ${pages.links.title}</h1>
                    <p>แสดงผลชื่อลิงก์และลิงก์ภายนอก</p>
                    ${isAdmin ? `
                    <div style="margin-bottom: 20px;">
                        <button class="btn-primary interactive-element" onclick="showAddLinkForm()">+ เพิ่มลิงก์ใหม่</button>
                    </div>
                    ` : ''}
                    
                    <div id="links-list">
                        <a href="#" target="_blank" class="card interactive-element" style="display: block; padding: 15px; text-decoration: none; color: ${isAdmin ? '#333' : 'var(--color-primary)'};">
                            <strong>ชื่อลิงก์:</strong> เว็บไซต์โรงเรียนสตรีพัทลุง | **URL:** spt.ac.th
                        </a>
                    </div>
                </div>
            `;
            // *ต้องเพิ่ม Logic ในการดึงข้อมูลจาก Firestore และฟังก์ชันสำหรับ Admin ในการเพิ่ม/แก้ไข*
        }

        function loadDocumentsContent() {
            const isAdmin = currentUserData.isAdmin;
            document.getElementById('app-content').innerHTML = `
                <div class="card">
                    <h1>📄 ${pages.documents.title}</h1>
                    <p>แสดงผลชื่อเอกสารและลิงก์สำหรับดาวน์โหลด/ดู</p>
                    ${isAdmin ? `
                    <div style="margin-bottom: 20px;">
                        <button class="btn-primary interactive-element" onclick="showAddDocumentForm()">+ เพิ่มเอกสารใหม่</button>
                    </div>
                    ` : ''}
                    
                    <div id="documents-list">
                        <div class="card interactive-element" style="padding: 15px; display: flex; justify-content: space-between; align-items: center;">
                            <span><strong>ชื่อเอกสาร:</strong> คู่มือโรงเรียนคุณธรรม 2567 (PDF)</span>
                            <a href="#" target="_blank" class="btn-secondary" style="padding: 5px 10px; text-decoration: none;">ดาวน์โหลด</a>
                        </div>
                    </div>
                </div>
            `;
            // *ต้องเพิ่ม Logic ในการดึงข้อมูลจาก Firestore/Storage และฟังก์ชันสำหรับ Admin ในการเพิ่ม/แก้ไข*
        }

        function loadAdminContent() {
            document.getElementById('app-content').innerHTML = `
                <div class="card">
                    <h1>⚙️ ${pages.admin.title}</h1>
                    <p style="font-size: 1.1em; font-weight: 600; color: red;">หน้านี้สำหรับ Admin เท่านั้น</p>
                </div>
                
                <div class="card">
                    <h2>1. การอนุมัติคำขอทั้งหมด</h2>
                    <p>ตารางรวมคำขอที่ต้องได้รับการอนุมัติ/ปฏิเสธ:</p>
                    <ul>
                        <li><a href="#">คำขอสมัครสมาชิก (Waiting: 5)</a></li>
                        <li><a href="#">คำขอเพิ่มกิจกรรม (Waiting: 2)</a></li>
                        <li><a href="#">คำขอเพิ่มปฏิทิน (Waiting: 1)</a></li>
                        <li><a href="#">คำขอยืมอุปกรณ์ (Waiting: 3)</a></li>
                    </ul>
                    <p>ในแต่ละลิงก์จะมีตารางสำหรับจัดการ <strong>อนุมัติ/ปฏิเสธ</strong></p>
                </div>
                
                <div class="card">
                    <h2>2. จัดการบัญชีผู้ใช้</h2>
                    <p>ตารางรายชื่อผู้ใช้ทั้งหมด (Approved/Pending)</p>
                    <table style="width: 100%; margin-top: 15px;">
                        <thead><tr><th>ชื่อ</th><th>อีเมล</th><th>สถานะ</th><th>จัดการ</th></tr></thead>
                        <tbody>
                            <tr><td>User A</td><td>userA@spt.ac.th</td><td>Approved</td><td><button onclick="changePass('uidA')">แก้ไขรหัสผ่าน</button> <button onclick="deleteAccount('uidA')">ลบบัญชี</button></td></tr>
                            <tr><td>User B</td><td>userB@spt.ac.th</td><td>Pending</td><td><button onclick="approveUser('uidB')">อนุมัติ</button> <button onclick="deleteAccount('uidB')">ปฏิเสธ/ลบ</button></td></tr>
                        </tbody>
                    </table>
                </div>
            `;
            // *ต้องเพิ่ม Logic ในการดึงข้อมูลทั้งหมด และฟังก์ชันสำหรับ Admin ในการอนุมัติ/ลบ/เปลี่ยนรหัสผ่าน*
        }

        // Initialize on load
        // The Firebase auth.onAuthStateChanged listener will automatically determine 
        // whether to show the auth-view or app-view.
    </script>
</body>
</html>
